rm(list = ls())
library(dplyr)
library(ggplot2)
library(lubridate)
library(lmodel2)
dat <- read.csv(file = "catch_dat_5_18_2021.csv", header=T, stringsAsFactors = F)
head(dat)
#load the catching data
dat <- read.csv(file = "catch_dat_5_18_2021.csv", header=T, stringsAsFactors = F)
head(dat)
data1 <- dplyr::select(dat,sampleid, roost_site, collection_date,
bat_species, bat_sex, bat_age_class, bat_weight_g,
body_length_cm, bat_forearm_mm, bat_tibia_mm,
ear_length_mm, gonad_length_mm, gonad_width_mm)
nrow(data1[is.na(data1$collection_date),])
###
###
data1$collection_date <- as.Date(data1$collection_date, format = "%m/%d/%y")
month(data1$collection_date)
data1$month= month(data1$collection_date)
data1$day= yday(data1$collection_date)
head(data)
head(data1)
Allspp <- filter(select(data1, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
bat_species %in% c("Eidolon dupreanum","Pteropus rufus","Rousettus madagascariensis"))
AllsppAdults1 <- filter(select(Allspp, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,                              bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
bat_age_class %in% c("A","NL","L"))
AllsppAdult_Mora <- filter(select(AllsppAdults1, sampleid,bat_species, roost_site,day, collection_date,month, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
roost_site %in% c("AngavoKely","AngavoBe","Ambakoana","Maromizaha","Marotsipohy", "Mahialambo", "Lakato", "Marovitsika"))
unique(AllsppAdult_Mora$roost_site)
sum(is.na(AllsppAdult_Mora))
AllsppAdult_Mora <- na.omit(AllsppAdult_Mora)
AllsppAdult_Mora$bat_weight_g= as.numeric(AllsppAdult_Mora$bat_weight_g)
AllsppAdult_Mora$bat_forearm_mm= as.numeric(AllsppAdult_Mora$bat_forearm_mm)
#first, plot it to visualize
p1 <- ggplot(data = AllsppAdult_Mora) + geom_point(aes(x=bat_forearm_mm,y=bat_weight_g))
print(p1) #this is all species together.
#you cannot fit a linear model without also including
#a transformation because the interaction here is exponential
#previously, you wrote:
#modAllspp <- lmodel2(bat_weight_g~bat_forearm_mm, data=AllsppAdult_Mora,nperm= 99)
#look with log10
p2 <- ggplot(data = AllsppAdult_Mora) + geom_point(aes(x=bat_forearm_mm,y=bat_weight_g)) +
scale_y_log10() + scale_x_log10()
print(p2)
Eid.df = subset(AllsppAdult_Mora, bat_species=="Eidolon dupreanum")
Eid.df = arrange(Eid.df, bat_weight_g)
head(Eid.df)
#  everything under 200 comes from that first week in January 2019. wasn't the caliper working incorrectly???
#also look at the big forearms
Eid.df = arrange(Eid.df, desc(bat_forearm_mm))
rm(list = ls())
library(dplyr)
library(ggplot2)
library(lubridate)
library(lmodel2)
#load the catching data
dat <- read.csv(file = "morph_paper_dat_7_23_2021.csv", header=T, stringsAsFactors = F)
head(dat)
data1 <- dplyr::select(dat,sampleid, roost_site, collection_date,
bat_species, bat_sex, bat_age_class, bat_weight_g,
body_length_cm, bat_forearm_mm, bat_tibia_mm,
ear_length_mm)
nrow(data1[is.na(data1$collection_date),])
###
###
data1$collection_date <- as.Date(data1$collection_date, format = "%m/%d/%y")
month(data1$collection_date)
#add month and day of year
data1$month= month(data1$collection_date)
data1$day= yday(data1$collection_date)
head(data1)
Allspp <- filter(select(data1, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
bat_species %in% c("Eidolon dupreanum","Pteropus rufus","Rousettus madagascariensis"))
Allspp <- filter(select(data1, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm),
bat_species %in% c("Eidolon dupreanum","Pteropus rufus","Rousettus madagascariensis"))
unique(Allspp$bat_age_class)
AllsppAdults1 <- filter(select(Allspp, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,                              bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
bat_age_class %in% c("A","NL","L", "P"))
### sub-select to just our 3 spp. of interest
Allspp <- filter(select(data1, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm),
bat_species %in% c("Eidolon dupreanum","Pteropus rufus","Rousettus madagascariensis"))
#sub-select to only the Adults (no "J" and no "NA")
unique(Allspp$bat_age_class)
AllsppAdults1 <- filter(select(Allspp, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,                              bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
bat_age_class %in% c("A","NL","L", "P"))
AllsppAdults1 <- filter(select(Allspp, sampleid,bat_species, roost_site, collection_date,month,day, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm),
bat_age_class %in% c("A","NL","L", "P"))
unique(AllsppAdults1$roost_site)
AllsppAdult_Mora <- filter(select(AllsppAdults1, sampleid,bat_species, roost_site,day, collection_date,month, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm, gonad_length_mm, gonad_width_mm),
roost_site %in% c("AngavoKely","Angavokely", "AngavoBe","Ambakoana","Maromizaha","Marotsipohy", "Mahialambo", "Lakato", "Marovitsika", "Mangarivotra"))
AllsppAdult_Mora <- filter(select(AllsppAdults1, sampleid,bat_species, roost_site,day, collection_date,month, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm),
roost_site %in% c("AngavoKely","Angavokely", "AngavoBe","Ambakoana","Maromizaha","Marotsipohy", "Mahialambo", "Lakato", "Marovitsika", "Mangarivotra"))
unique(AllsppAdult_Mora$roost_site)
sum(is.na(AllsppAdult_Mora))
AllsppAdult_Mora <- na.omit(AllsppAdult_Mora)
AllsppAdult_Mora <- filter(select(AllsppAdults1, sampleid,bat_species, roost_site,day, collection_date,month, bat_sex,
bat_age_class, bat_weight_g, bat_forearm_mm, bat_tibia_mm, ear_length_mm, body_length_cm),
roost_site %in% c("AngavoKely","Angavokely", "AngavoBe","Ambakoana","Maromizaha","Marotsipohy", "Mahialambo", "Lakato", "Marovitsika", "Mangarivotra"))
unique(AllsppAdult_Mora$roost_site)
is.na(AllsppAdult_Mora)
AllsppAdult_Mora[is.na(AllsppAdult_Mora),]
#remove NA rows at the bottom
AllsppAdult_Mora[is.na(AllsppAdult_Mora),]
sum(is.na(AllsppAdult_Mora))
#remove NAs
AllsppAdult_Mora <- na.omit(AllsppAdult_Mora)
#######
AllsppAdult_Mora$bat_weight_g= as.numeric(AllsppAdult_Mora$bat_weight_g)
AllsppAdult_Mora$bat_forearm_mm= as.numeric(AllsppAdult_Mora$bat_forearm_mm)
#first, plot it to visualize
p1 <- ggplot(data = AllsppAdult_Mora) + geom_point(aes(x=bat_forearm_mm,y=bat_weight_g))
print(p1) #this is all species together.
#you cannot fit a linear model without also including
#a transformation because the interaction here is exponential
#previously, you wrote:
#modAllspp <- lmodel2(bat_weight_g~bat_forearm_mm, data=AllsppAdult_Mora,nperm= 99)
#look with log10
p2 <- ggplot(data = AllsppAdult_Mora) + geom_point(aes(x=bat_forearm_mm,y=bat_weight_g)) +
scale_y_log10() + scale_x_log10()
print(p2)
Eid.df = subset(AllsppAdult_Mora, bat_species=="Eidolon dupreanum")
Eid.df = arrange(Eid.df, bat_weight_g)
head(Eid.df)
tail(head(Eid.df))
tail(Eid.df)
#  everything under 200 comes from that first week in January 2019. wasn't the caliper working incorrectly???
#also look at the big forearms
Eid.df = arrange(Eid.df, desc(bat_forearm_mm))
#those over 150 are erroneous
head(Eid.df)
#and Pter
Pter.df = subset(AllsppAdult_Mora, bat_species=="Pteropus rufus")
Pter.df = arrange(Pter.df, bat_forearm_mm)
head(Pter.df) #116 is too low
Rou.df = subset(AllsppAdult_Mora, bat_species=="Rousettus madagascariensis")
Rou.df = arrange(Rou.df, bat_forearm_mm)
head(Rou.df) #first three <50 are way low and all from the same day
Pter.df = arrange(Pter.df, bat_weight_g)
head(Pter.df)
tail(Pter.df)
head(Pter.df)
tail(Pter.df)
Rou.df = subset(AllsppAdult_Mora, bat_species=="Rousettus madagascariensis")
Rou.df = arrange(Rou.df, bat_forearm_mm)
head(Rou.df) #first three <50 are way low and all from the same day
Rou.df = arrange(Rou.df, bat_weight_g)
Rou.df = arrange(Rou.df, bat_forearm_mm)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, bat_weight_g)
head(Rou.df)
tail(Rou.df)
Rou.df = arrange(Rou.df, bat_weight_g)
head(Rou.df)
tail(Rou.df)
Pter.df = arrange(Pter.df, bat_forearm_mm)
head(Pter.df) #116 is too low
Pter.df = arrange(Pter.df, bat_weight_g)
head(Pter.df)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, bat_weight_g)
head(Rou.df)
tail(Rou.df)
Eid.df = arrange(Eid.df, bat_tibia_mm)
head(Eid.df)
tail(Eid.df)
head(Eid.df)
tail(Eid.df)
Eid.df = arrange(Eid.df, ear_length_mm)
head(Eid.df)
tail(Eid.df)
head(Eid.df)
tail(Eid.df)
Pter.df = arrange(Pter.df, bat_tibia_mm)
head(Pter.df)
tail(Pter.df)
head(Pter.df)
head(Pter.df)
Pter.df = arrange(Pter.df, bat_tibia_mm)
head(Pter.df)
tail(Pter.df)
Pter.df = arrange(Pter.df, ear_length_mm)
head(Pter.df)
tail(Pter.df)
Rou.df = arrange(Rou.df, bat_tibia_mm)
Rou.df = arrange(Rou.df, ear_length_mm)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, bat_tibia_mm)
Rou.df = arrange(Rou.df, ear_length_mm)
head(Rou.df) #first three <50 are way low and all from the same day
Rou.df = arrange(Rou.df, bat_tibia_mm)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, ear_length_mm)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, ear_length_mm)
head(Rou.df) #first three <50 are way low and all from the same day
tail(Rou.df)
Rou.df = arrange(Rou.df, bat_weight_g)
head(Rou.df)
tail(Rou.df)
150-25
150-35
150-55
